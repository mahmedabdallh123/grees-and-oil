# ملف: create_excel.py (تشغيله مرة واحدة لإنشاء ملف Excel)
import pandas as pd
from datetime import datetime

# إنشاء بيانات الماكينات
machines_data = {
    'id': [1, 2],
    'اسم الماكينة': ['ماكينة الإنتاج رقم 1', 'ماكينة التعبئة'],
    'الموديل': ['XP-2000', 'Filler-300'],
    'الرقم التسلسلي': ['SN001', 'SN002'],
    'تاريخ التركيب': ['2024-01-01', '2024-03-15'],
    'إجمالي ساعات التشغيل': [1500, 800],
    'آخر تحديث للساعات': [datetime.now().strftime('%Y-%m-%d %H:%M'), datetime.now().strftime('%Y-%m-%d %H:%M')],
    'ملاحظات': ['الماكينة الرئيسية', 'ماكينة التعبئة والتغليف'],
    'نشطة': ['نعم', 'نعم'],
    'تاريخ الإضافة': [datetime.now().strftime('%Y-%m-%d'), datetime.now().strftime('%Y-%m-%d')]
}

# إنشاء بيانات المهام
tasks_data = {
    'id': [1, 2, 3, 4],
    'معرف الماكينة': [1, 1, 2, 2],
    'نوع الصيانة': ['تغيير الزيت', 'التشحيم', 'تغيير الزيت', 'تنظيف الفلاتر'],
    'الفترة بين الصيانة (ساعات)': [500, 200, 600, 300],
    'تاريخ آخر صيانة': ['2024-02-01', '2024-06-01', '2024-05-01', '2024-04-01'],
    'عدد ساعات التشغيل عند آخر صيانة': [1000, 1300, 500, 400],
    'عدد الساعات المتبقية': [0, 0, 300, 100],
    'تاريخ الصيانة القادم': ['2024-02-01', '2024-06-01', '2024-08-01', '2024-07-01'],
    'وصف المهمة': ['تغيير زيت المحرك الرئيسي', 'تشحيم جميع النقاط', 'تغيير زيت المحرك', 'تنظيف فلاتر الهواء'],
    'نشطة': ['نعم', 'نعم', 'نعم', 'نعم'],
    'تاريخ الإضافة': [datetime.now().strftime('%Y-%m-%d'), datetime.now().strftime('%Y-%m-%d'), 
                     datetime.now().strftime('%Y-%m-%d'), datetime.now().strftime('%Y-%m-%d')]
}

# إنشاء بيانات السجل
logs_data = {
    'id': [1, 2, 3],
    'معرف الماكينة': [1, 1, 2],
    'معرف المهمة': [1, 2, 3],
    'تاريخ الصيانة': ['2024-02-01', '2024-06-01', '2024-05-01'],
    'عدد ساعات التشغيل': [1000, 1300, 500],
    'تمت بواسطة': ['أحمد محمد', 'علي محمود', 'محمود سعيد'],
    'الأجزاء المستبدلة': ['زيت محرك 5 لتر', 'شحم صناعي', 'زيت محرك 3 لتر'],
    'ملاحظات': ['تم تغيير الزيت بنجاح', 'تم التشحيم', 'تم تغيير الزيت'],
    'تاريخ التسجيل': [datetime.now().strftime('%Y-%m-%d'), datetime.now().strftime('%Y-%m-%d'), 
                      datetime.now().strftime('%Y-%m-%d')]
}

# إنشاء بيانات الإعدادات
settings_data = {
    'الإعداد': ['إشعار مسبق (أيام)', 'البريد الإلكتروني للإشعارات', 'تفعيل الإشعارات', 'لون التطبيق'],
    'القيمة': ['7', 'admin@company.com', 'نعم', 'أزرق'],
    'الوصف': ['عدد الأيام للإشعار المسبق قبل الصيانة', 'البريد الإلكتروني لإرسال الإشعارات', 
              'تفعيل أو تعطيل الإشعارات', 'لون واجهة التطبيق']
}

# تحويل البيانات إلى DataFrames
machines_df = pd.DataFrame(machines_data)
tasks_df = pd.DataFrame(tasks_data)
logs_df = pd.DataFrame(logs_data)
settings_df = pd.DataFrame(settings_data)

# حفظ في ملف Excel
with pd.ExcelWriter('machines.xlsx', engine='openpyxl') as writer:
    machines_df.to_excel(writer, sheet_name='الماكينات', index=False)
    tasks_df.to_excel(writer, sheet_name='المهام', index=False)
    logs_df.to_excel(writer, sheet_name='السجل', index=False)
    settings_df.to_excel(writer, sheet_name='الإعدادات', index=False)

print("✅ تم إنشاء ملف machines.xlsx بنجاح!")
